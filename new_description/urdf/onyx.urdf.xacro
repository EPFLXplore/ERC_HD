<?xml version="1.0" ?>
<robot name="onyx" xmlns:xacro="http://www.ros.org/wiki/xacro">

<xacro:include filename="$(find new_description)/urdf/materials.xacro" />
<!-- <xacro:include filename="$(find new_description)/urdf/onyx.trans" /> -->
<xacro:include filename="$(find new_description)/urdf/onyx.gazebo" />


<xacro:property name="rpm_to_Radps" value="${2*pi/60.0}" />     <!-- rotations per minute to Rad per second conversion -->
<xacro:property name="velocity_scaling" value="1.0" />     <!-- allows to scale all max velocities down at once -->

<xacro:macro name="aaa_joint_limits" params="lower:=0.0 upper:=0.0 velocity:=${rpm_to_Radps} effort:=100.0">
  <limit lower="${lower}" upper="${upper}" velocity="${velocity}" effort="${effort}"/>
</xacro:macro>

<xacro:property name="joint1_limits">
  <xacro:aaa_joint_limits lower="${-2*pi}" upper="${2*pi}" velocity="${1.83 * rpm_to_Radps * velocity_scaling}" />
</xacro:property>

<xacro:property name="joint2_limits">
  <xacro:aaa_joint_limits lower="${-pi}" upper="${pi}" velocity="${1.377 * rpm_to_Radps * velocity_scaling}" />
</xacro:property>

<xacro:property name="joint3_limits">
  <xacro:aaa_joint_limits lower="${-pi}" upper="${pi}" velocity="${1.377 * rpm_to_Radps * velocity_scaling}" />
</xacro:property>

<xacro:property name="joint4_limits">
  <xacro:aaa_joint_limits lower="${-2*pi}" upper="${2*pi}" velocity="${1.83 * rpm_to_Radps * velocity_scaling}" />
</xacro:property>

<xacro:property name="joint5_limits">
  <xacro:aaa_joint_limits lower="${-pi}" upper="${pi}" velocity="${1.83 * rpm_to_Radps * velocity_scaling}" />
</xacro:property>

<xacro:property name="joint6_limits">
  <xacro:aaa_joint_limits lower="${-2*pi}" upper="${2*pi}" velocity="${1.83 * rpm_to_Radps * velocity_scaling}" />
</xacro:property>

<xacro:property name="finger_limits">
  <xacro:aaa_joint_limits lower="${-pi}" upper="${pi}" velocity="${10 * rpm_to_Radps}" />
</xacro:property>


<xacro:macro name="inertial_box" params="mass x y z">
      <inertial>
          <mass value="${mass}" />
          <inertia ixx="${(1/12) * mass * (y*y+z*z)}" ixy="0.0" ixz="0.0"
                  iyy="${(1/12) * mass * (x*x+z*z)}" iyz="0.0"
                  izz="${(1/12) * mass * (x*x+y*y)}" />
      </inertial>
  </xacro:macro>



<!-- def compile(mass: float = 1.0, x: float = 0.0, y: float = 0.0, z: float = 0.0):
    def build_intertia_block(ixx: float, iyy: float, izz: float, ixy: float, iyz: float, ixz: float):
        template = '<inertia ixx="%g" iyy="%g" izz="%g" ixy="%g" iyz="%g" ixz="%g"/>'
        return template % (ixx, iyy, izz, ixy, iyz, ixz)
    
    return build_intertia_block(
        ixx = 1/12 * mass * (y**2 + z**2),
        ixy = 0.0,
        ixz = 0.0,
        iyy = 1/12 * mass * (x**2 + z**2),
        iyz = 0.0,
        izz = 11/12 * mass * (x**2 + y**2),
    ) -->


<link name="base_link">
  <inertial>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <mass value="10"/>
    <!-- <inertia ixx="0.00171" iyy="0.00171" izz="0.003332" ixy="-0.0" iyz="0.0" ixz="0.0"/> -->
    <inertia ixx="0.866667" iyy="0.241667" izz="11.4583" ixy="0" iyz="0" ixz="0"/>
  </inertial>
  <visual>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <box size="0.5 1 0.2"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <box size="0.5 1 0.2"/>
    </geometry>
  </collision>
</link>


<link name="link0">
  <inertial>
    <origin xyz="1.1956123958086707e-13 -3.565798973482466e-17 0.006224605561972922" rpy="0 0 0"/>
    <mass value="1.001112718637754"/>
    <inertia ixx="0.00171" iyy="0.00171" izz="0.003332" ixy="-0.0" iyz="0.0" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="link1">
  <inertial>
    <origin xyz="-0.02170210910358164 -0.00019279531117990834 -0.10150898066165266" rpy="0 0 0"/>
    <mass value="4.649589662802901"/>
    <inertia ixx="0.020834" iyy="0.028672" izz="0.018541" ixy="9.3e-05" iyz="8e-06" ixz="-0.002669"/>
  </inertial>
  <visual>
    <origin xyz="-0.0 -0.0 -0.0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._J3_J4_v1_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.0 -0.0 -0.0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._J3_J4_v1_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="link2">
  <inertial>
    <origin xyz="0.011067557585022744 -0.1859999999999968 -6.38378239159465e-16" rpy="0 0 0"/>
    <mass value="3.1139206406559206"/>
    <inertia ixx="0.069339" iyy="0.005977" izz="0.067529" ixy="-0.0" iyz="-0.0" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="0.1185 0.0 0.1185" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._bras_1_signle_component_v2_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.1185 0.0 0.1185" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._bras_1_signle_component_v2_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="link3">
  <inertial>
    <origin xyz="0.09679789089640704 -0.016991019338346014 -0.0001927953111762748" rpy="0 0 0"/>
    <mass value="4.649589662802901"/>
    <inertia ixx="0.020834" iyy="0.018541" izz="0.028672" ixy="0.002669" iyz="-8e-06" ixz="9.3e-05"/>
  </inertial>
  <visual>
    <origin xyz="0.1185 0.372 0.1185" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._J3_J4_v1_3.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.1185 0.372 0.1185" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._J3_J4_v1_3.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="link4">
  <inertial>
    <origin xyz="-7.62739739510274e-14 -0.15487679697152396 0.003331504937344451" rpy="0 0 0"/>
    <mass value="2.3051495546208427"/>
    <inertia ixx="0.026991" iyy="0.004302" izz="0.027883" ixy="-0.0" iyz="0.00098" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="0.0 0.4905 0.1185" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._bras_2_single_component_v2_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.0 0.4905 0.1185" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._bras_2_single_component_v2_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="link5">
  <inertial>
    <origin xyz="-0.021702109103615613 -0.00019279531117755155 -0.10150898066164708" rpy="0 0 0"/>
    <mass value="4.649589662802901"/>
    <inertia ixx="0.020834" iyy="0.028672" izz="0.018541" ixy="9.3e-05" iyz="8e-06" ixz="-0.002669"/>
  </inertial>
  <visual>
    <origin xyz="0.0 0.7625 0.1025" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._J3_J4_v1_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.0 0.7625 0.1025" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._J3_J4_v1_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="link6">
  <inertial>
    <origin xyz="-0.04986729813628965 -0.00013910374698444805 -0.00012272189332909744" rpy="0 0 0"/>
    <mass value="0.47056920048889883"/>
    <inertia ixx="0.000306" iyy="0.001335" izz="0.001186" ixy="-4e-06" iyz="0.0" ixz="-0.0"/>
  </inertial>
  <visual>
    <origin xyz="0.1185 0.7625 0.221" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._simplified_gripper_single_component_v5_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.1185 0.7625 0.221" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/1._simplified_gripper_single_component_v5_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="Arm_A_v6_2">
  <inertial>
    <origin xyz="0.018951336567798988 -0.0037499223695921513 0.03443137459651863" rpy="0 0 0"/>
    <mass value="0.11091056155247334"/>
    <inertia ixx="0.000106" iyy="0.000118" izz="1.4e-05" ixy="-0.0" iyz="-0.0" ixz="1.1e-05"/>
  </inertial>
  <visual>
    <origin xyz="0.2232 0.78502 0.20602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.2232 0.78502 0.20602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="Arm_A_v6_1">
  <inertial>
    <origin xyz="0.018951336567799487 -0.003749922521991911 -0.03443121948811595" rpy="0 0 0"/>
    <mass value="0.11091056155247334"/>
    <inertia ixx="0.000106" iyy="0.000118" izz="1.4e-05" ixy="0.0" iyz="-0.0" ixz="-1.1e-05"/>
  </inertial>
  <visual>
    <origin xyz="0.2232 0.78502 0.23602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.2232 0.78502 0.23602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<!-- <link name="Arm_A_v6_2_opo">
  <inertial>
    <origin xyz="0.018951336567798988 -0.0037499223695921513 0.03443137459651863" rpy="0 0 0"/>
    <mass value="0.11091056155247334"/>
    <inertia ixx="0.000106" iyy="0.000118" izz="1.4e-05" ixy="-0.0" iyz="-0.0" ixz="1.1e-05"/>
  </inertial>
  <visual>
    <origin xyz="0.2232 0.78502 0.20602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.2232 0.78502 0.20602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="Arm_A_v6_1_opo">
  <inertial>
    <origin xyz="0.018951336567799487 -0.003749922521991911 -0.03443121948811595" rpy="0 0 0"/>
    <mass value="0.11091056155247334"/>
    <inertia ixx="0.000106" iyy="0.000118" izz="1.4e-05" ixy="0.0" iyz="-0.0" ixz="-1.1e-05"/>
  </inertial>
  <visual>
    <origin xyz="0.2232 0.78502 0.23602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.2232 0.78502 0.23602" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Arm_A_v6_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link> -->

<link name="Hand_v3_2">
  <inertial>
    <origin xyz="0.009334274146256122 0.022500077554207798 9.812474983245112e-06" rpy="0 0 0"/>
    <mass value="0.025619526396878787"/>
    <inertia ixx="4e-06" iyy="4e-06" izz="7e-06" ixy="0.0" iyz="0.0" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="0.220282 0.78502 0.11944" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Hand_v3_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.220282 0.78502 0.11944" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Hand_v3_2.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="Hand_v3_1">
  <inertial>
    <origin xyz="0.009334274146256205 0.022500077554208908 9.462970156470796e-06" rpy="0 0 0"/>
    <mass value="0.025619526396878787"/>
    <inertia ixx="4e-06" iyy="4e-06" izz="7e-06" ixy="0.0" iyz="0.0" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="0.220282 0.78502 0.3226" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Hand_v3_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.220282 0.78502 0.3226" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find new_description)/meshes/Hand_v3_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>




<joint name="arm_fixation" type="fixed">
  <origin xyz="0.0 0.4 0.11" rpy="${pi} 0 0"/>
  <parent link="base_link"/>
  <child link="link0"/>
  <!-- <axis xyz="0.0 0.9 1.0"/> -->
  <xacro:insert_block name="joint1_limits"/>
</joint>

<joint name="hd_joint1" type="revolute">
  <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  <parent link="link0"/>
  <child link="link1"/>
  <axis xyz="0.0 0.0 1.0"/>
  <xacro:insert_block name="joint1_limits"/>
</joint>

<joint name="hd_joint2" type="revolute">
  <origin xyz="-0.1185 -0.0 -0.1185" rpy="${pi/2} 0 0"/>
  <parent link="link1"/>
  <child link="link2"/>
  <axis xyz="1.0 -0.0 -0.0"/>
  <xacro:insert_block name="joint2_limits"/>
</joint>

<joint name="hd_joint3" type="revolute">
  <origin xyz="0.0 -0.372 0.0" rpy="0 0 0"/>
  <parent link="link2"/>
  <child link="link3"/>
  <axis xyz="-1.0 0.0 0.0"/>
  <xacro:insert_block name="joint3_limits"/>
</joint>

<joint name="hd_joint4" type="revolute">
  <origin xyz="0.1185 -0.1185 0.0" rpy="0 ${pi/2} 0"/>
  <parent link="link3"/>
  <child link="link4"/>
  <axis xyz="0.0 1.0 -0.0"/>
  <xacro:insert_block name="joint4_limits"/>
</joint>

<joint name="hd_joint5" type="revolute">
  <origin xyz="0.0 -0.272 0.016" rpy="0 0 ${pi/2}"/>
  <parent link="link4"/>
  <child link="link5"/>
  <axis xyz="-0.0 0.0 1.0"/>
  <xacro:insert_block name="joint5_limits"/>
</joint>

<joint name="hd_joint6" type="revolute">
  <origin xyz="-0.1185 0.0 -0.1185" rpy="0 0 0"/>
  <parent link="link5"/>
  <child link="link6"/>
  <axis xyz="1.0 -0.0 0.0"/>
  <xacro:insert_block name="joint6_limits"/>
</joint>

<joint name="finger_joint1" type="continuous">
  <origin xyz="-0.1047 -0.02252 0.01498" rpy="0 ${-pi/2} 0"/>
  <parent link="link6"/>
  <child link="Arm_A_v6_2"/>
  <axis xyz="0.0 1.0 -0.0"/>
  <!-- <xacro:insert_block name="finger_limits"/> -->
</joint>

<joint name="finger_joint2" type="continuous">
  <origin xyz="-0.1047 -0.02252 -0.01502" rpy="0 ${pi/2} 0"/>
  <parent link="link6"/>
  <child link="Arm_A_v6_1"/>
  <axis xyz="0.0 1.0 -0.0"/>
  <mimic joint="finger_joint1" multiplier="-1"/>
</joint>

<!-- <joint name="finger_joint1_opo" type="continuous">
  <origin xyz="-0.1047 0.02252 0.01498" rpy="0 ${-pi/2} 0"/>
  <parent link="link6"/>
  <child link="Arm_A_v6_2_opo"/>
  <axis xyz="0.0 1.0 -0.0"/>
  <mimic joint="finger_joint1" multiplier="1"/>
</joint>

<joint name="finger_joint2_opo" type="continuous">
  <origin xyz="-0.1047 0.02252 -0.01502" rpy="0 ${pi/2} 0"/>
  <parent link="link6"/>
  <child link="Arm_A_v6_1_opo"/>
  <axis xyz="0.0 1.0 -0.0"/>
  <mimic joint="finger_joint1" multiplier="-1"/>
</joint> -->

<joint name="finger_joint3" type="continuous">
  <origin xyz="0.002918 0.0 0.08658" rpy="0 0 0"/>
  <parent link="Arm_A_v6_2"/>
  <child link="Hand_v3_2"/>
  <axis xyz="-0.0 -1.0 0.0"/>
  <mimic joint="finger_joint1" multiplier="1"/>
</joint>

<joint name="finger_joint4" type="continuous">
  <origin xyz="0.002918 0.0 -0.08658" rpy="0 0 0"/>
  <parent link="Arm_A_v6_1"/>
  <child link="Hand_v3_1"/>
  <axis xyz="0.0 -1.0 0.0"/>
  <mimic joint="finger_joint1" multiplier="-1"/>
</joint>

</robot>
